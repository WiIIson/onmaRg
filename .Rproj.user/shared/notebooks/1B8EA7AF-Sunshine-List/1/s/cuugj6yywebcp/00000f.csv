"0",""
"0","get_data <- function(method, division) {"
"0","  # Determines the division of the data"
"0","  if (division==""none"") {"
"0","    working_data <- sunshine_gender %>%"
"0","      group_by(Calendar.Year)"
"0","  }"
"0","  else if (division==""gender"") {"
"0","    working_data <- sunshine_gender %>%"
"0","      group_by(Calendar.Year, gender)"
"0","  }"
"0","  "
"0","  # Determines the statistic to report"
"0","  if (method==""num"") {"
"0","    working_data <- working_data %>%"
"0","      summarise(entries=n())"
"0","  }"
"0","  else if (method==""avg"") {"
"0","    working_data <- working_data %>%"
"0","      summarise(entries=mean(Salary.Paid))"
"0","  }"
"0","  else if (method==""max"") {"
"0","    working_data <- working_data %>%"
"0","      summarise(entries=max(Salary.Paid))"
"0","  }"
"0","  "
"0","  working_data <- data.frame(working_data)"
"0","  "
"0","  print(working_data)"
"0","  "
"0","  # Generates the plot"
"0","  if(division==""none"") {"
"0","    plot <- ggplot(data=working_data, aes(x=Calendar.Year, y=entries)) +"
"0","      geom_bar(stat=""identity"")"
"0","  }"
"0","  else {"
"0","    plot <- ggplot(data=working_data, aes(x=Calendar.Year, y=entries, fill=gender)) +"
"0","      geom_bar(stat=""identity"", position=""fill"") +"
"0","      geom_hline(yintercept=0.5)"
"0","  }"
"0","  "
"0","  return(plot)"
"0","}"
"0",""
"0","ui <- fluidPage("
"0","  titlePanel(""Sunshine List Member Data""),"
"0","  fluidRow("
"0","    column(3,"
"0","      radioButtons("
"0","        ""Stat_Display"","
"0","        ""Statistic Shown"","
"0","        c("
"0","          ""Count""=""num"","
"0","          ""Average""=""avg"","
"0","          ""Maximum""=""max"""
"0","        )"
"0","      ),"
"0","      radioButtons("
"0","        ""Division"","
"0","        ""Division"","
"0","        c("
"0","          ""Overall""=""none"","
"0","          ""Gender""=""gender"""
"0","        )"
"0","      )"
"0","    )"
"0","  ),"
"0","  fluidRow("
"0","    plotOutput(""Sunshine_Display"", height=600)"
"0","  )"
"0",")"
"0","  "
"0","server <- function(input, output, session) {"
"0","  observeEvent(input$Stat_Display, {"
"0","    output$Sunshine_Display <- renderPlot("
"0","      get_data(input$Stat_Display, input$Division)"
"0","    )"
"0","  })"
"0","  "
"0","  observeEvent(input$Division, {"
"0","    output$Sunshine_Display <- renderPlot("
"0","      get_data(input$Stat_Display, input$Division)"
"0","    )"
"0","  })"
"0","}"
"0",""
"0","shinyApp(ui, server)"
"2","
Listening on http://127.0.0.1:7696
"
